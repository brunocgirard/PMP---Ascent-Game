/**
 * mobile-ux-fixes.css
 * Fixes for mobile navigation and card layout issues
 */

/* ========================================
   MOBILE CARD LAYOUT - USE FULL WIDTH
   ======================================== */

@media (max-width: 767px) {
  /* Remove side padding constraints on mobile - use minimal padding */
  .container,
  .main-content {
    padding-left: var(--space-sm);
    padding-right: var(--space-sm);
    max-width: 100%;
  }

  /* Header container */
  .header-content {
    padding-left: var(--space-sm);
    padding-right: var(--space-sm);
  }

  /* Mission/Task cards should use full available width */
  .mission-grid {
    padding: 0;
    margin: var(--space-md) 0;
  }

  .mission-card,
  .task-card,
  .card {
    width: 100%;
    max-width: 100%;
    margin-left: 0;
    margin-right: 0;
  }

  /* Learn section content cards - full width */
  .learn-section-content,
  .section-content,
  .content-card {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: var(--space-md) !important;
    padding-right: var(--space-md) !important;
  }

  /* Section container - full width */
  .section-container {
    max-width: 100% !important;
    width: 100% !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Challenge/scenario cards */
  .challenge-card,
  .scenario-card {
    width: 100% !important;
    max-width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  /* Enhanced MVE container - full width on mobile */
  .enhanced-mve-container {
    max-width: 100% !important;
    width: 100% !important;
    padding: var(--space-md) var(--space-sm) !important;
    margin: 0 !important;
  }

  /* All section wrappers - full width */
  .section-wrapper,
  [class*="section-"] {
    max-width: 100% !important;
    width: 100% !important;
  }

  /* Task landing page full width on mobile */
  .task-landing-page {
    max-width: 100%;
    padding: var(--space-lg) var(--space-md);
  }

  /* Learning content full width */
  .learn-content,
  .flashcard-container,
  .quiz-container {
    max-width: 100%;
    padding: 0 var(--space-md);
  }

  /* Flashcard full width */
  .flashcard {
    width: 100%;
    max-width: 100%;
    min-height: 300px;
  }

  /* Quiz question cards full width */
  .quiz-question {
    width: 100%;
    max-width: 100%;
  }

  /* Answer options full width */
  .answer-option {
    width: 100%;
    padding: var(--space-md);
    min-height: 56px;
  }
}

/* ========================================
   NAVIGATION RIBBON/BUTTONS FIX
   ======================================== */

@media (max-width: 767px) {
  /* Section Navigation Footer - FIX for Learn sections */
  .section-navigation-footer {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    padding: var(--space-md) !important;
    background: white !important;
    border-top: 2px solid var(--color-gray-200) !important;
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1) !important;
    z-index: 1040 !important;
  }

  /* Inner container - remove max-width constraint */
  .section-navigation-footer > div {
    max-width: 100% !important;
    width: 100% !important;
    margin: 0 !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: var(--space-sm) !important;
    padding: 0 !important;
  }

  /* Hide the middle "Next:" text on mobile */
  .nav-middle-text {
    display: none !important;
  }

  /* Ensure both buttons are visible and sized properly */
  .section-navigation-footer .btn {
    flex: 1 !important;
    max-width: 48% !important;
    min-width: 0 !important;
    padding: var(--space-md) var(--space-sm) !important;
    font-size: var(--font-size-sm) !important;
    min-height: 48px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }

  /* Bottom navigation bar - ensure both buttons visible */
  .task-navigation,
  .bottom-navigation,
  .nav-buttons,
  .navigation-bar,
  .task-nav-buttons,
  .phase-navigation {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md);
    background: var(--color-background-white);
    border-top: 1px solid var(--color-gray-200);
    box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.1);
    z-index: 100;
    min-height: 72px;
  }

  /* Navigation buttons */
  .btn-prev,
  .btn-next,
  .nav-btn-prev,
  .nav-btn-next,
  button[class*="prev"],
  button[class*="next"] {
    flex: 1;
    min-width: 0;
    max-width: 48%;
    padding: var(--space-md) var(--space-sm);
    font-size: var(--font-size-base);
    min-height: 48px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Ensure "Next" button is always visible */
  .btn-next,
  .nav-btn-next,
  button[class*="next"] {
    margin-left: auto;
  }

  /* If only one button (Next), center it or make it full width */
  .task-navigation:has(.btn-next:only-child) .btn-next,
  .bottom-navigation:has(.btn-next:only-child) .btn-next,
  .nav-buttons:has(.btn-next:only-child) .btn-next {
    max-width: 100%;
  }

  /* Resume prompt buttons */
  .resume-prompt {
    grid-template-columns: 1fr;
    gap: var(--space-md);
    padding: var(--space-md);
  }

  .resume-actions {
    flex-direction: row;
    width: 100%;
  }

  .resume-actions .btn {
    flex: 1;
    min-height: 44px;
  }

  /* Phase flow navigation (Learn → Flashcards → Quiz) */
  .phase-flow-nav {
    width: 100%;
    padding: var(--space-md);
    display: flex;
    gap: var(--space-sm);
  }

  .phase-flow-nav .btn {
    flex: 1;
    min-height: 48px;
    font-size: var(--font-size-sm);
  }

  /* Add bottom padding to content to prevent overlap with fixed nav */
  .main-content,
  .learn-content,
  .flashcard-container,
  .quiz-container,
  .enhanced-mve-container,
  .section-container {
    padding-bottom: calc(80px + var(--space-xl)) !important;
  }

  /* Ensure last elements in sections have extra padding */
  .section-content > *:last-child,
  .learn-section-content > *:last-child {
    margin-bottom: var(--space-2xl) !important;
  }

  /* Flashcard navigation */
  .flashcard-navigation {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--space-md);
    background: var(--color-background-white);
    border-top: 1px solid var(--color-gray-200);
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-md);
    z-index: 100;
  }

  .flashcard-navigation .btn {
    flex: 1;
    min-height: 48px;
  }

  .flashcard-counter {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    white-space: nowrap;
  }

  /* Quiz navigation */
  .quiz-navigation {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: var(--space-md);
    background: var(--color-background-white);
    border-top: 1px solid var(--color-gray-200);
    display: flex;
    justify-content: space-between;
    gap: var(--space-md);
    z-index: 100;
  }

  .quiz-navigation .btn {
    min-height: 48px;
  }

  .btn-submit-quiz {
    flex: 1;
  }
}

/* ========================================
   DESKTOP - SHOW MIDDLE TEXT
   ======================================== */

@media (min-width: 768px) {
  /* Show middle navigation text on larger screens */
  .nav-middle-text {
    display: block !important;
  }

  /* Adjust button sizing for desktop */
  .section-navigation-footer .btn {
    flex: 0 0 auto !important;
    max-width: none !important;
    min-width: 140px !important;
  }

  /* Content can use wider layout on desktop */
  .section-content {
    max-width: 900px !important;
    margin: 0 auto !important;
    padding: var(--space-xl) !important;
  }

  .enhanced-mve-container {
    max-width: 1000px !important;
    padding: 2rem 1rem !important;
  }
}

/* ========================================
   ENSURE BUTTONS ARE TAPPABLE
   ======================================== */

@media (max-width: 767px) {
  /* All navigation buttons minimum touch target */
  .btn-prev,
  .btn-next,
  .btn-continue,
  .btn-skip,
  .btn-submit,
  button[class*="nav"] {
    min-height: 48px;
    min-width: 48px;
    touch-action: manipulation;
    -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
  }

  /* Prevent double-tap zoom on buttons */
  button,
  .btn,
  a.btn {
    touch-action: manipulation;
  }

  /* Ensure clickable area extends to button boundaries */
  button,
  .btn {
    position: relative;
  }

  button::after,
  .btn::after {
    content: '';
    position: absolute;
    top: -8px;
    left: -8px;
    right: -8px;
    bottom: -8px;
    z-index: -1;
  }
}

/* ========================================
   MISSION SELECTION IMPROVEMENTS
   ======================================== */

@media (max-width: 767px) {
  /* Mission cards clickable area */
  .mission-card {
    padding: var(--space-lg) var(--space-md);
  }

  .mission-card a {
    display: block;
    padding: var(--space-sm);
    margin: calc(var(--space-sm) * -1);
    min-height: 48px;
  }

  /* Mission number badge */
  .mission-number {
    min-width: 40px;
    min-height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Task options cards */
  .task-option-card {
    padding: var(--space-lg);
    min-height: 120px;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .task-option-card .btn {
    width: 100%;
    margin-top: auto;
  }
}

/* ========================================
   TASK LEARNING PHASE INDICATORS
   ======================================== */

@media (max-width: 767px) {
  /* Phase indicator pills */
  .phase-indicator {
    position: fixed;
    top: 60px; /* Below header */
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-md);
    background: var(--color-background-white);
    border-radius: var(--radius-full);
    box-shadow: var(--shadow-sm);
    z-index: 90;
  }

  .phase-pill {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--color-gray-300);
  }

  .phase-pill.active {
    background: var(--color-primary-blue);
    width: 24px;
    border-radius: var(--radius-full);
  }

  .phase-pill.completed {
    background: var(--color-trust-green);
  }
}
